<!DOCTYPE html>
<html class="dark" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: blob:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; connect-src https://api.cursor.com https://jules.googleapis.com https://api.openai.com https://api.anthropic.com;">
  <title>Agent Dash | Developer Mode</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@300;400;500;600;700;800;900&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/output.css">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
    .technical-font { font-family: 'JetBrains Mono', monospace; }
  </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 min-h-screen">
<div id="app" class="flex h-screen overflow-hidden">
  <!-- Sidebar -->
  <aside id="sidebar" class="w-64 flex-shrink-0 bg-sidebar-dark border-r border-slate-800 flex flex-col justify-between p-4">
    <div class="flex flex-col gap-8">
      <!-- Logo -->
      <div class="flex items-center gap-3 px-2">
        <div class="bg-primary rounded-lg p-1.5 flex items-center justify-center">
          <span class="material-symbols-outlined text-white" style="font-size: 24px;">terminal</span>
        </div>
        <div class="flex flex-col">
          <h1 class="text-white text-base font-bold leading-none">Agent Dash</h1>
          <p class="text-slate-500 text-[10px] font-medium uppercase tracking-wider mt-1">Developer Mode</p>
        </div>
      </div>
      <!-- Nav -->
      <nav class="flex flex-col gap-1">
        <button data-view="dashboard" class="nav-btn flex items-center gap-3 px-3 py-2.5 rounded-lg bg-primary/10 text-primary hover:bg-slate-800 hover:text-white transition-colors text-left w-full">
          <span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1;">home</span>
          <p class="text-sm font-semibold">Home</p>
        </button>
        <button data-view="branches" class="nav-btn flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors text-left w-full">
          <span class="material-symbols-outlined">folder</span>
          <p class="text-sm font-medium">Repositories</p>
        </button>
        <button data-view="computers" class="nav-btn flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors text-left w-full">
          <span class="material-symbols-outlined">computer</span>
          <p class="text-sm font-medium">Computers</p>
        </button>
        <button data-view="jira" class="nav-btn flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors text-left w-full">
          <span class="material-symbols-outlined">confirmation_number</span>
          <p class="text-sm font-medium">Jira Tickets</p>
        </button>
        <button data-view="settings" class="nav-btn flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors text-left w-full">
          <span class="material-symbols-outlined">settings</span>
          <p class="text-sm font-medium">Settings</p>
        </button>
      </nav>
    </div>
    <!-- Bottom Sidebar -->
    <div class="flex flex-col gap-4">
      <!-- Usage (Static) -->
      <div class="px-3 py-3 rounded-xl bg-slate-800/50 border border-slate-700/50">
        <div class="flex items-center justify-between mb-2">
          <p class="text-[11px] font-bold text-slate-400 uppercase tracking-widest">Usage</p>
          <p class="text-[11px] font-bold text-white">72%</p>
        </div>
        <div class="w-full bg-slate-700 h-1.5 rounded-full overflow-hidden">
          <div class="bg-primary h-full w-[72%]"></div>
        </div>
      </div>
      <!-- New Task Button -->
      <button id="new-task-btn" class="flex w-full items-center justify-center gap-2 rounded-lg h-11 bg-primary hover:bg-primary/90 text-white text-sm font-bold transition-all shadow-lg shadow-primary/20">
        <span class="material-symbols-outlined text-sm">add</span>
        <span>New Agent Task</span>
      </button>
    </div>

    <!-- Hidden legacy filters for JS compatibility -->
    <div id="sidenav-providers" class="hidden">
       <!-- Kept to prevent errors, but provider filtering via sidebar is removed in new design -->
       <input type="checkbox" id="filter-gemini" class="provider-filter" checked>
       <input type="checkbox" id="filter-jules" class="provider-filter" checked>
       <input type="checkbox" id="filter-cursor" class="provider-filter" checked>
       <input type="checkbox" id="filter-codex" class="provider-filter" checked>
       <input type="checkbox" id="filter-claude-cli" class="provider-filter" checked>
       <input type="checkbox" id="filter-claude-cloud" class="provider-filter" checked>

       <span id="count-gemini"></span><span id="status-gemini"></span>
       <span id="count-jules"></span><span id="status-jules"></span>
       <span id="count-cursor"></span><span id="status-cursor"></span>
       <span id="count-codex"></span><span id="status-codex"></span>
       <span id="count-claude-cli"></span><span id="status-claude-cli"></span>
       <span id="count-claude-cloud"></span><span id="status-claude-cloud"></span>
       <span id="status-github"></span>
    </div>
    <div id="sidenav-status" class="hidden">
       <input type="checkbox" id="filter-running" class="status-filter" checked>
       <input type="checkbox" id="filter-completed" class="status-filter" checked>
       <input type="checkbox" id="filter-pending" class="status-filter" checked>
       <input type="checkbox" id="filter-failed" class="status-filter" checked>
    </div>
  </aside>

  <main class="flex-1 overflow-y-auto bg-background-light dark:bg-background-dark">
    <div class="max-w-[1200px] mx-auto px-8 pt-8 h-full flex flex-col">

      <!-- Dashboard View -->
      <div id="view-dashboard" class="view-content flex flex-col h-full">
        <!-- Dashboard Header -->
        <div class="flex flex-wrap items-center justify-between gap-4 border-b border-slate-200 dark:border-slate-800 pb-6 shrink-0">
          <div class="flex flex-col gap-1">
            <h2 id="view-title" class="text-3xl font-black tracking-tight text-slate-900 dark:text-white">Running Tasks</h2>
            <p class="text-slate-500 dark:text-slate-400 text-sm font-medium">Monitoring active coding agents across cloud and local environments <span id="total-count" class="ml-2 text-xs opacity-70"></span></p>
          </div>
          <div class="flex items-center gap-3">
            <div class="relative">
              <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg">search</span>
              <input id="search-input" class="pl-10 pr-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm focus:ring-2 focus:ring-primary focus:border-transparent outline-none w-64 text-slate-900 dark:text-white placeholder:text-slate-500 transition-all duration-200" placeholder="Search tasks..." type="text"/>
            </div>
            <button id="refresh-btn" class="flex items-center justify-center gap-2 rounded-lg h-10 px-4 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-sm font-bold hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors">
              <span id="refresh-icon" class="material-symbols-outlined text-lg">refresh</span>
              <span>Refresh</span>
            </button>
          </div>
        </div>

        <!-- Status Tabs -->
        <div class="flex border-b border-slate-200 dark:border-slate-800 gap-8 mt-4 shrink-0">
          <button id="tab-all" class="status-tab active flex flex-col items-center justify-center border-b-2 border-primary text-primary pb-3 pt-2 font-bold text-sm outline-none" onclick="filterByStatusTab('all')">
            All Tasks
          </button>
          <button id="tab-running" class="status-tab flex flex-col items-center justify-center border-b-2 border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 pb-3 pt-2 font-bold text-sm outline-none" onclick="filterByStatusTab('running')">
            In Progress
          </button>
          <button id="tab-completed" class="status-tab flex flex-col items-center justify-center border-b-2 border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 pb-3 pt-2 font-bold text-sm outline-none" onclick="filterByStatusTab('completed')">
            Completed
          </button>
          <button id="tab-failed" class="status-tab flex flex-col items-center justify-center border-b-2 border-transparent text-slate-500 hover:text-red-500 dark:hover:text-red-400 pb-3 pt-2 font-bold text-sm outline-none" onclick="filterByStatusTab('failed')">
            Errors
          </button>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto py-8">
           <!-- Loading/Empty/Error States -->
           <div id="loading-state" class="flex flex-col items-center justify-center h-64">
             <span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span>
             <p class="mt-4 technical-font text-slate-400">Loading...</p>
           </div>

           <div id="empty-state" class="hidden flex flex-col items-center justify-center h-64">
              <span class="material-symbols-outlined text-slate-600 text-6xl">computer</span>
              <h3 class="mt-4 text-lg font-bold dark:text-white uppercase tracking-tight">No Agents Detected</h3>
              <p class="mt-2 text-slate-500 text-center max-w-md text-sm">
                Configure API command keys in Settings to establish connection.
              </p>
              <button onclick="showView('settings')" class="mt-4 bg-primary text-black px-6 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">
                Open Settings
              </button>
           </div>

           <div id="error-banner" class="hidden mb-4 p-4 bg-red-900/20 border border-red-900/50 rounded-lg">
             <div class="flex items-start gap-3">
               <span class="material-symbols-outlined text-red-400 mt-0.5">error</span>
               <div>
                 <h4 class="text-sm font-bold text-red-300 uppercase">Errors Detected</h4>
                 <ul id="error-list" class="mt-1 text-sm text-red-400 list-disc list-inside"></ul>
               </div>
             </div>
           </div>

           <!-- Grid -->
           <div id="agents-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5">
             <!-- Cards go here -->
           </div>

           <!-- Pagination -->
           <div id="pagination-controls" class="hidden flex items-center justify-between mt-8 pt-6 border-t border-slate-200 dark:border-slate-800">
             <span id="pagination-info" class="technical-font text-xs text-slate-500">SHOWING 1-50 OF 100 TASKS</span>
             <div class="flex items-center gap-4">
               <button id="prev-page-btn" class="flex items-center gap-2 px-4 py-2 text-xs font-semibold rounded-lg border border-slate-300 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200 text-slate-600 dark:text-slate-400 disabled:opacity-40 disabled:cursor-not-allowed">
                 <span class="material-symbols-outlined text-sm">chevron_left</span>
                 PREV
               </button>
               <span id="page-indicator" class="technical-font text-xs text-primary font-bold">PAGE 01 / 01</span>
               <button id="next-page-btn" class="flex items-center gap-2 px-4 py-2 text-xs font-semibold rounded-lg border border-slate-300 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200 text-slate-600 dark:text-slate-400 disabled:opacity-40 disabled:cursor-not-allowed">
                 NEXT
                 <span class="material-symbols-outlined text-sm">chevron_right</span>
               </button>
             </div>
           </div>
        </div>
      </div>

      <!-- Branches View -->
      <div id="view-branches" class="view-content hidden h-full flex flex-col">
         <div class="flex items-center justify-between border-b border-slate-200 dark:border-slate-800 pb-6 mb-6">
            <div class="flex items-center gap-4">
               <h3 class="text-3xl font-black tracking-tight text-slate-900 dark:text-white">Repositories</h3>
               <span id="repo-count" class="text-slate-500 text-sm font-medium bg-slate-200 dark:bg-slate-800 px-2 py-1 rounded">0 repos</span>
            </div>
            <div class="flex items-center gap-3">
              <button id="create-repo-btn" class="bg-primary text-black flex items-center gap-2 px-3 py-1.5 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">
                 <span class="material-symbols-outlined text-sm">add</span>
                 New Repo
              </button>
              <button id="refresh-branches-btn" class="flex items-center gap-2 px-3 py-1.5 text-xs font-semibold rounded-lg border border-slate-300 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200 text-slate-600 dark:text-slate-400">
                 <span class="material-symbols-outlined text-sm">refresh</span>
                 Refresh
              </button>
            </div>
         </div>

         <div id="branches-loading" class="hidden flex flex-col items-center justify-center h-64">
            <span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span>
            <p class="mt-4 text-sm text-slate-400 font-medium">Fetching Repositories...</p>
         </div>

         <div id="branches-empty" class="hidden flex flex-col items-center justify-center h-64">
            <span class="material-symbols-outlined text-slate-600 text-6xl">fork_right</span>
            <h3 class="mt-4 text-lg font-semibold dark:text-white tracking-tight">No Repositories Found</h3>
            <p class="mt-2 text-slate-500 text-center max-w-md text-sm">Connect your GitHub account in Settings.</p>
            <button onclick="showView('settings')" class="mt-4 bg-primary text-black px-6 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">Open Settings</button>
         </div>

         <div id="branches-content" class="hidden flex-1 overflow-hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-full">
               <div class="lg:col-span-1 border border-slate-200 dark:border-slate-800 bg-white dark:bg-[#1A1A1A] rounded-xl flex flex-col h-[calc(100vh-200px)] overflow-hidden">
                  <div class="p-4 border-b border-slate-200 dark:border-slate-800">
                     <input type="text" id="repo-filter" placeholder="Filter repos..." class="w-full bg-slate-50 dark:bg-black border border-slate-200 dark:border-slate-700 text-slate-800 dark:text-slate-300 text-xs py-2 px-3 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all">
                  </div>
                  <div id="repo-list" class="flex-1 overflow-y-auto p-2 space-y-1"></div>
               </div>
               
               <div class="lg:col-span-2 border border-slate-200 dark:border-slate-800 bg-white dark:bg-[#1A1A1A] rounded-xl flex flex-col h-[calc(100vh-200px)] overflow-hidden">
                  <div id="repo-details-placeholder" class="flex flex-col items-center justify-center h-full text-slate-500">
                     <span class="material-symbols-outlined text-4xl mb-2">arrow_back</span>
                     <span class="text-sm font-medium">Select a repository</span>
                  </div>
                  <div id="repo-details-content" class="hidden flex flex-col h-full">
                     <div class="p-6 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-black/20">
                        <h2 id="selected-repo-name" class="text-xl font-semibold text-slate-800 dark:text-white tracking-tight">Repo Name</h2>
                        <div class="flex items-center gap-3">
                           <a id="selected-repo-link" href="#" class="bg-primary text-black px-3 py-1.5 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] flex items-center gap-2 transition-all duration-200">
                              <span class="material-symbols-outlined text-sm">open_in_new</span> Visit Repo
                           </a>
                           <div class="flex bg-slate-200 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 p-0.5 rounded-lg gap-0.5">
                              <button id="pr-filter-open" class="px-3 py-1 text-xs font-medium rounded-md transition-all bg-primary text-black">Open</button>
                              <button id="pr-filter-closed" class="px-3 py-1 text-xs font-medium rounded-md transition-all text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200">Closed</button>
                           </div>
                           <span class="px-2 py-1.5 text-xs font-medium bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-700 rounded-lg flex items-center">
                              <span id="pr-count" class="mr-1">0</span> <span id="pr-status-text">PRs</span>
                           </span>
                        </div>
                     </div>
                     <div id="pr-list" class="flex-1 overflow-y-auto p-6 space-y-4"></div>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <!-- Computers View -->
      <div id="view-computers" class="view-content hidden h-full flex flex-col">
         <div class="border-b border-slate-200 dark:border-slate-800 pb-6 mb-6">
            <h2 class="text-3xl font-black tracking-tight text-slate-900 dark:text-white">Computers</h2>
         </div>
         <div id="computers-loading" class="hidden flex flex-col items-center justify-center h-64">
            <span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span>
            <p class="mt-4 technical-font text-slate-400">Fetching Computers...</p>
         </div>
         <div id="computers-empty" class="hidden flex flex-col items-center justify-center h-64">
            <span class="material-symbols-outlined text-slate-600 text-6xl">computer</span>
            <h3 class="mt-4 text-lg font-bold dark:text-white uppercase tracking-tight">No Computers Found</h3>
            <p id="computers-empty-subtitle" class="mt-2 text-slate-500 text-center max-w-md text-sm">Configure Cloudflare KV in Settings.</p>
            <button onclick="showView('settings')" class="mt-4 bg-primary text-black px-6 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">Open Settings</button>
         </div>
         <div id="computers-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
      </div>

      <!-- Jira View -->
      <div id="view-jira" class="view-content hidden h-full flex flex-col">
         <div class="border-b border-slate-200 dark:border-slate-800 pb-6 mb-6">
            <h2 class="text-3xl font-black tracking-tight text-slate-900 dark:text-white">Jira Tickets</h2>
         </div>
         <div id="jira-loading" class="hidden flex flex-col items-center justify-center h-64">
             <span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span>
             <p class="mt-4 technical-font text-slate-400">Fetching Jira...</p>
         </div>
         <div id="jira-empty" class="hidden flex flex-col items-center justify-center h-64">
             <span class="material-symbols-outlined text-slate-600 text-6xl">assignment</span>
             <h3 class="mt-4 text-lg font-bold dark:text-white uppercase tracking-tight">Jira Not Configured</h3>
             <p class="mt-2 text-slate-500 text-center max-w-md text-sm">Configure Jira Base URL and API Token in Settings.</p>
             <button onclick="showView('settings')" class="mt-4 bg-primary text-black px-6 py-2 text-xs technical-font font-bold hover:brightness-110 transition-all">Open Settings</button>
         </div>
         <div id="jira-content" class="hidden flex flex-col h-full">
             <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-4">
                   <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">Jira Board</h3>
                   <select id="jira-board-select" class="bg-black border border-border-dark text-slate-300 technical-font text-xs py-1 px-3 focus:ring-1 focus:ring-primary focus:border-primary transition-all cursor-pointer hover:border-slate-600">
                      <option value="">Select Board...</option>
                   </select>
                   <select id="jira-assignee-filter" class="bg-black border border-border-dark text-slate-300 technical-font text-xs py-1 px-3 focus:ring-1 focus:ring-primary focus:border-primary transition-all cursor-pointer hover:border-slate-600">
                      <option value="">All Users</option>
                   </select>
                </div>
                <div class="flex items-center gap-3">
                   <button id="refresh-jira-btn" class="flex items-center gap-2 px-3 py-1.5 text-xs font-semibold rounded-lg border border-slate-300 dark:border-border-dark hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200 text-slate-600 dark:text-slate-400">
                      <span class="material-symbols-outlined text-sm">refresh</span> REFRESH
                   </button>
                </div>
             </div>
             <div id="jira-issues-list" class="flex-1 overflow-y-auto space-y-2"></div>
         </div>
      </div>

      <!-- Settings View -->
      <div id="view-settings" class="view-content hidden h-full flex flex-col">
         <div class="border-b border-slate-200 dark:border-slate-800 pb-6 mb-6">
            <h2 class="text-3xl font-black tracking-tight text-slate-900 dark:text-white">Settings</h2>
         </div>
         <!-- I'm reusing the existing settings form structure, just ensuring containers are right -->
         <div class="max-w-4xl mx-auto w-full space-y-8 pb-10">
            <!-- API Keys Section -->
            <section class="bg-white dark:bg-[#1A1A1A] border border-slate-200 dark:border-slate-800 p-8 rounded-xl">
              <div class="flex items-center gap-3 mb-8">
                <span class="material-symbols-outlined text-primary">key</span>
                <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">API Command Keys</h3>
              </div>
              <div class="space-y-8">
                <!-- Keep inputs same IDs -->
                <!-- Jira -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Jira Base URL</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="text" id="jira-base-url" placeholder="https://your-domain.atlassian.net" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-jira-base-url" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                  </div>
                </div>
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Jira API Token</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="jira-api-key" placeholder="Enter token" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-jira-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-jira-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-jira-key" class="border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20 hidden"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- Jules -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Jules API Key</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="jules-api-key" placeholder="Enter key" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-jules-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-jules-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-jules-key" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- Cursor -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Cursor API Key</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="cursor-api-key" placeholder="Enter key" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-cursor-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-cursor-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-cursor-key" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- Codex -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Codex API Key</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="codex-api-key" placeholder="Enter key" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-codex-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-codex-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-codex-key" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- Claude -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Claude API Key</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="claude-api-key" placeholder="Enter key" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-claude-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-claude-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-claude-key" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- GitHub -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">GitHub Token</label>
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="github-api-key" placeholder="Enter token" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-github-key" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-github-key" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-github-key" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                </div>
                <!-- Cloudflare -->
                <div class="space-y-2">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Cloudflare</label>
                  <input type="text" id="cloudflare-account-id" placeholder="Account ID" class="mb-2 w-full bg-slate-100 dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display">
                  <div class="flex gap-2 inner-glow">
                    <input type="password" id="cloudflare-api-token" placeholder="API Token" class="flex-1 bg-white dark:bg-black/40 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary/20 focus:border-primary rounded-lg text-sm py-2.5 px-4 text-slate-800 dark:text-white font-display placeholder:text-slate-500 transition-all duration-200">
                    <button id="save-cloudflare-config" class="bg-primary text-black px-6 py-2.5 text-[10px] font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">SAVE</button>
                    <button id="test-cloudflare-config" class="border border-slate-300 dark:border-slate-700 text-slate-600 dark:text-slate-400 px-6 py-2.5 text-[10px] font-semibold rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 active:scale-[0.98] transition-all duration-200">TEST</button>
                    <button id="disconnect-cloudflare-config" class="hidden border border-red-900/50 text-red-400 px-4 py-2.5 text-[10px] technical-font font-bold hover:bg-red-900/20"><span class="material-symbols-outlined text-sm">link_off</span></button>
                  </div>
                  <div class="flex gap-2 mt-4 hidden" id="cloudflare-key-sync-controls">
                    <button id="push-keys-cf" class="border border-slate-700 text-slate-400 hover:text-primary px-4 py-2 text-[10px] technical-font font-bold">PUSH KEYS</button>
                    <button id="pull-keys-cf" class="border border-slate-700 text-slate-400 hover:text-primary px-4 py-2 text-[10px] technical-font font-bold">PULL KEYS</button>
                  </div>
                </div>
              </div>
            </section>

            <!-- Other settings sections (Display, CLI Paths, System) omitted for brevity in thought but required in file -->
            <!-- I will assume the previous content was fine and just ensure IDs are there. -->
            <!-- Actually I should include them to be safe. I'll paste them. -->

            <!-- Display Settings -->
            <section class="bg-white dark:bg-[#1A1A1A] border border-slate-200 dark:border-slate-800 p-8 rounded-xl">
               <div class="flex items-center gap-3 mb-8">
                  <span class="material-symbols-outlined text-primary">monitor</span>
                  <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">Display</h3>
               </div>
               <div class="space-y-4">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">App Theme</label>
                  <div class="grid grid-cols-3 gap-4">
                     <button id="theme-system" class="theme-btn flex flex-col items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 hover:border-primary transition-all bg-slate-50 dark:bg-black/20">
                        <span class="material-symbols-outlined text-slate-500">settings_brightness</span>
                        <span class="text-[10px] technical-font font-bold text-slate-600 dark:text-slate-400">SYSTEM</span>
                     </button>
                     <button id="theme-light" class="theme-btn flex flex-col items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 hover:border-primary transition-all bg-slate-50 dark:bg-black/20">
                        <span class="material-symbols-outlined text-slate-500">light_mode</span>
                        <span class="text-[10px] technical-font font-bold text-slate-600 dark:text-slate-400">LIGHT</span>
                     </button>
                     <button id="theme-dark" class="theme-btn flex flex-col items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 hover:border-primary transition-all bg-slate-50 dark:bg-black/20">
                        <span class="material-symbols-outlined text-slate-500">dark_mode</span>
                        <span class="text-[10px] technical-font font-bold text-slate-600 dark:text-slate-400">DARK</span>
                     </button>
                  </div>
               </div>
               <div class="space-y-4 mt-8">
                  <label class="block text-[10px] technical-font text-slate-500 dark:text-slate-400">Window Mode</label>
                  <div class="grid grid-cols-2 gap-4">
                     <button id="display-windowed" class="display-btn flex flex-col items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 hover:border-primary transition-all bg-slate-50 dark:bg-black/20">
                        <span class="material-symbols-outlined text-slate-500">grid_view</span>
                        <span class="text-[10px] technical-font font-bold text-slate-600 dark:text-slate-400">WINDOWED</span>
                     </button>
                     <button id="display-fullscreen" class="display-btn flex flex-col items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 hover:border-primary transition-all bg-slate-50 dark:bg-black/20">
                        <span class="material-symbols-outlined text-slate-500">fullscreen</span>
                        <span class="text-[10px] technical-font font-bold text-slate-600 dark:text-slate-400">FULL SCREEN</span>
                     </button>
                  </div>
               </div>
            </section>

            <!-- Polling -->
            <section class="bg-white dark:bg-[#1A1A1A] border border-slate-200 dark:border-slate-800 p-8 rounded-xl">
               <div class="flex items-center gap-3 mb-8">
                  <span class="material-symbols-outlined text-primary">history</span>
                  <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">Data Polling</h3>
               </div>
               <div class="space-y-8">
                  <div class="flex items-center gap-3">
                     <input type="checkbox" id="auto-polling" class="form-checkbox h-4 w-4 bg-transparent border-primary text-primary focus:ring-0">
                     <label class="text-sm technical-font text-slate-300 cursor-pointer" for="auto-polling">Enable auto refresh</label>
                  </div>
                  <div class="space-y-4">
                     <div class="flex justify-between items-end">
                        <label class="text-[10px] technical-font text-slate-500">Refresh interval</label>
                        <span class="text-primary font-display font-bold"><span id="interval-value">30</span> SECONDS</span>
                     </div>
                     <input type="range" id="polling-interval" min="5" max="300" step="5" class="w-full cursor-pointer">
                  </div>
               </div>
            </section>

            <!-- Paths -->
            <section class="bg-white dark:bg-[#1A1A1A] border border-slate-200 dark:border-slate-800 p-8 rounded-xl">
               <div class="flex items-center gap-3 mb-8">
                  <span class="material-symbols-outlined text-primary">terminal</span>
                  <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">CLI Tools Paths</h3>
               </div>
               <!-- Gemini -->
               <div class="mb-8 border-b border-slate-700 pb-8">
                  <h4 class="text-sm font-bold text-slate-300 uppercase mb-4">Gemini CLI</h4>
                  <div class="mb-4 p-3 bg-slate-700/20 border border-slate-700"><span class="text-[9px] technical-font text-slate-400">Default path:</span> <p id="default-gemini-path" class="text-sm text-slate-300 font-mono">--</p></div>
                  <div class="flex gap-2 mb-4">
                     <input type="text" id="new-gemini-path" placeholder="Add custom path..." class="flex-1 bg-black/40 border border-slate-700 focus:border-primary text-sm py-2.5 px-4 text-white">
                     <button id="browse-gemini-path" class="bg-slate-800 border border-slate-700 text-slate-300 px-4 py-2.5"><span class="material-symbols-outlined text-sm">folder_open</span></button>
                     <button id="add-gemini-path" class="bg-emerald-600 text-white px-6 py-2.5 text-[10px] font-bold">ADD</button>
                  </div>
                  <div id="gemini-paths-list" class="space-y-2"></div>
               </div>
               <!-- Other paths (Claude, Cursor, Codex, GitHub) - simplified copy -->
               <!-- Claude -->
               <div class="mb-8 border-b border-slate-700 pb-8">
                  <h4 class="text-sm font-bold text-slate-300 uppercase mb-4">Claude CLI</h4>
                  <div class="flex gap-2 mb-4">
                     <input type="text" id="new-claude-path" placeholder="Add custom path..." class="flex-1 bg-black/40 border border-slate-700 focus:border-primary text-sm py-2.5 px-4 text-white">
                     <button id="browse-claude-path" class="bg-slate-800 border border-slate-700 text-slate-300 px-4 py-2.5"><span class="material-symbols-outlined text-sm">folder_open</span></button>
                     <button id="add-claude-path" class="bg-emerald-600 text-white px-6 py-2.5 text-[10px] font-bold">ADD</button>
                  </div>
                  <div id="claude-paths-list" class="space-y-2"></div>
               </div>
               <!-- Cursor -->
               <div class="mb-8 border-b border-slate-700 pb-8">
                  <h4 class="text-sm font-bold text-slate-300 uppercase mb-4">Cursor CLI</h4>
                  <div class="flex gap-2 mb-4">
                     <input type="text" id="new-cursor-path" placeholder="Add custom path..." class="flex-1 bg-black/40 border border-slate-700 focus:border-primary text-sm py-2.5 px-4 text-white">
                     <button id="browse-cursor-path" class="bg-slate-800 border border-slate-700 text-slate-300 px-4 py-2.5"><span class="material-symbols-outlined text-sm">folder_open</span></button>
                     <button id="add-cursor-path" class="bg-emerald-600 text-white px-6 py-2.5 text-[10px] font-bold">ADD</button>
                  </div>
                  <div id="cursor-paths-list" class="space-y-2"></div>
               </div>
               <!-- Codex -->
               <div class="mb-8 border-b border-slate-700 pb-8">
                  <h4 class="text-sm font-bold text-slate-300 uppercase mb-4">Codex CLI</h4>
                  <div class="flex gap-2 mb-4">
                     <input type="text" id="new-codex-path" placeholder="Add custom path..." class="flex-1 bg-black/40 border border-slate-700 focus:border-primary text-sm py-2.5 px-4 text-white">
                     <button id="browse-codex-path" class="bg-slate-800 border border-slate-700 text-slate-300 px-4 py-2.5"><span class="material-symbols-outlined text-sm">folder_open</span></button>
                     <button id="add-codex-path" class="bg-emerald-600 text-white px-6 py-2.5 text-[10px] font-bold">ADD</button>
                  </div>
                  <div id="codex-paths-list" class="space-y-2"></div>
               </div>
               <!-- GitHub Paths -->
               <div>
                  <h4 class="text-sm font-bold text-slate-300 uppercase mb-4">GitHub Paths</h4>
                  <div class="flex gap-2 mb-4">
                     <input type="text" id="new-github-path" placeholder="Add path..." class="flex-1 bg-black/40 border border-slate-700 focus:border-primary text-sm py-2.5 px-4 text-white">
                     <button id="browse-github-path" class="bg-slate-800 border border-slate-700 text-slate-300 px-4 py-2.5"><span class="material-symbols-outlined text-sm">folder_open</span></button>
                     <button id="add-github-path" class="bg-emerald-600 text-white px-6 py-2.5 text-[10px] font-bold">ADD</button>
                  </div>
                  <div id="github-paths-list" class="space-y-2"></div>
                  <div id="github-paths-empty" class="text-center py-6 text-slate-500 technical-font text-sm">No paths configured.</div>
               </div>
            </section>

            <!-- System -->
            <section class="bg-white dark:bg-[#1A1A1A] border border-slate-200 dark:border-slate-800 p-8 rounded-xl">
               <div class="flex items-center gap-3 mb-8">
                  <span class="material-symbols-outlined text-primary">system_update</span>
                  <h3 class="text-lg font-bold dark:text-white uppercase tracking-tight">System</h3>
               </div>
               <div class="flex items-center justify-between">
                  <div>
                     <h4 class="text-sm font-bold text-slate-700 dark:text-slate-300">Update Application</h4>
                     <p class="text-[10px] technical-font text-slate-500 mt-1">Pull latest changes from GitHub.</p>
                  </div>
                  <button id="update-app-btn" class="bg-primary text-black px-6 py-2.5 text-[10px] technical-font font-bold hover:brightness-110 flex items-center gap-2">
                     <span class="material-symbols-outlined text-sm">download</span> UPDATE & RESTART
                  </button>
               </div>
            </section>
         </div>
      </div>

    </div>
  </main>
</div>

<!-- Copy of Modals from original file (New Task, Create Repo, etc.) - Preserved -->
<!-- I'm just pasting the same modal code as before since it works and is hidden by default -->
<div id="new-task-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closeNewTaskModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-3xl flex flex-col shadow-2xl rounded-xl overflow-hidden">
    <div class="border-b border-slate-700 p-6 flex justify-between items-center bg-black/40">
      <div class="flex items-center gap-4"><span class="material-symbols-outlined text-primary text-2xl">rocket_launch</span><div><h2 class="text-lg font-semibold text-white tracking-tight">New Task</h2><p class="text-xs text-slate-500 font-normal">Configure and launch an AI agent</p></div></div>
      <button onclick="closeNewTaskModal()" class="text-slate-500 hover:text-primary transition-colors rounded-lg p-1 hover:bg-white/5"><span class="material-symbols-outlined">close</span></button>
    </div>
    <div class="p-8 space-y-8 max-h-[70vh] overflow-y-auto">
      <section>
        <div class="flex items-center gap-3 mb-4"><span class="flex items-center justify-center w-6 h-6 border border-primary text-xs font-medium text-primary rounded-md">01</span><h3 class="font-semibold text-slate-300">Choose Service</h3></div>
        <div class="mb-6"><label class="text-xs text-slate-500 mb-2 block font-medium">Target Device</label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm">devices</span><select id="new-task-target-device" class="w-full bg-black border border-slate-700 text-slate-300 text-xs py-3 pl-10 pr-4 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all cursor-pointer hover:border-slate-600"><option value="">This Computer (Local)</option></select><span class="absolute right-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm pointer-events-none">expand_more</span></div></div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
          <button type="button" id="service-gemini" onclick="selectService('gemini')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">terminal</span><div class="text-sm font-semibold text-slate-300 mb-1">Gemini CLI</div><div class="text-xs text-slate-500 leading-tight">Local projects via Google API</div></button>
          <button type="button" id="service-jules" onclick="selectService('jules')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">code</span><div class="text-sm font-semibold text-slate-300 mb-1">Jules</div><div class="text-xs text-slate-500 leading-tight">GitHub repos via Jules API</div></button>
          <button type="button" id="service-cursor" onclick="selectService('cursor')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">near_me</span><div class="text-sm font-semibold text-slate-300 mb-1">Cursor</div><div class="text-xs text-slate-500 leading-tight">Cloud-based via Cursor API</div></button>
          <button type="button" id="service-codex" onclick="selectService('codex')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">psychology</span><div class="text-sm font-semibold text-slate-300 mb-1">Codex</div><div class="text-xs text-slate-500 leading-tight">Cloud tasks via OpenAI</div></button>
          <button type="button" id="service-claude-cli" onclick="selectService('claude-cli')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">terminal</span><div class="text-sm font-semibold text-slate-300 mb-1">Claude CLI</div><div class="text-xs text-slate-500 leading-tight">Local projects via CLI</div></button>
          <button type="button" id="service-claude-cloud" onclick="selectService('claude-cloud')" class="service-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><span class="material-symbols-outlined text-slate-400 mb-3">cloud</span><div class="text-sm font-semibold text-slate-300 mb-1">Claude Cloud</div><div class="text-xs text-slate-500 leading-tight">Anthropic API</div></button>
        </div>
        <p id="service-status" class="mt-3 text-xs technical-font text-slate-500"></p>
      </section>
      <section>
        <div class="flex items-center gap-3 mb-4"><span class="flex items-center justify-center w-6 h-6 border border-slate-600 text-xs font-medium text-slate-400 rounded-md">02</span><h3 class="font-semibold text-slate-300">Configure Target</h3></div>
        <div class="space-y-4">
          <div>
            <label class="text-xs text-slate-500 mb-2 block font-medium">Repository</label>
            <div class="relative" id="repo-search-container">
              <input type="text" id="task-repo-search" disabled autocomplete="off" placeholder="Select service first..." class="w-full bg-black border border-slate-700 text-slate-300 text-xs py-3 pl-4 pr-10 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all disabled:opacity-50 disabled:cursor-not-allowed">
              <input type="hidden" id="task-repo" value="">
              <div id="repo-loading" class="hidden absolute right-3 top-1/2 -translate-y-1/2"><span class="material-symbols-outlined text-primary text-sm animate-spin">sync</span></div>
              <span id="repo-chevron" class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 cursor-pointer">expand_more</span>
              <div id="repo-dropdown" class="hidden absolute z-50 w-full mt-1 max-h-60 overflow-y-auto bg-black border border-slate-700 shadow-lg rounded-lg overflow-hidden"></div>
            </div>
            <p id="repo-error" class="mt-1 text-xs text-red-400 hidden"></p>
          </div>
          <div id="branch-input-container" class="grid grid-cols-2 gap-4">
            <div><label class="text-xs text-slate-500 mb-2 block font-medium">Branch</label><select id="task-branch" class="w-full bg-black border border-slate-700 text-slate-300 text-xs py-3 px-4 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all"><option value="main">main</option></select></div>
            <div><label class="text-xs text-slate-500 mb-2 block font-medium">Auto PR</label><div class="flex items-center gap-3 h-[46px]"><input type="checkbox" id="task-auto-pr" checked class="form-checkbox h-4 w-4 bg-transparent border-primary text-primary focus:ring-0 rounded"><label class="text-xs text-slate-400 cursor-pointer font-normal" for="task-auto-pr">Enabled</label></div></div>
          </div>
        </div>
      </section>
      <section>
        <div class="flex items-center gap-3 mb-4"><span class="flex items-center justify-center w-6 h-6 border border-slate-600 text-xs font-medium text-slate-400 rounded-md">03</span><h3 class="font-semibold text-slate-300">Describe Task</h3></div>
        <div>
          <div class="flex items-center justify-between mb-2"><label class="text-xs text-slate-500 block font-medium">Task Description</label><div class="flex items-center gap-1 border border-slate-700 bg-black rounded-lg overflow-hidden"><button id="task-prompt-tab-write" type="button" onclick="setTaskPromptMode('write')" class="px-3 py-1 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-colors">Write</button><button id="task-prompt-tab-preview" type="button" onclick="setTaskPromptMode('preview')" class="px-3 py-1 text-xs font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-colors">Preview</button></div></div>
          <div class="relative"><textarea id="task-prompt" rows="7" placeholder="Write Description... (paste images directly here)" class="w-full bg-black border border-slate-700 text-slate-300 font-sans text-sm p-4 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all resize-none"></textarea><div id="task-prompt-preview" class="hidden w-full bg-black border border-slate-700 text-slate-200 font-sans text-sm p-4 rounded-lg leading-relaxed max-h-64 overflow-y-auto"></div><button id="task-speech-btn" class="absolute bottom-3 right-3 text-slate-500 hover:text-primary transition-colors p-1 rounded-full hover:bg-white/5" title="Speech to text"><span class="material-symbols-outlined">mic</span></button></div>
          <div id="task-prompt-images-container" class="hidden mt-3 bg-black border border-slate-700 p-3 rounded-lg"><div class="flex items-center justify-between mb-2"><span class="text-xs text-slate-500 font-medium">Pasted Images</span><span id="task-prompt-images-count" class="text-xs text-slate-600 font-medium">0</span></div><div id="task-prompt-images" class="flex flex-wrap gap-3"></div></div>
        </div>
      </section>
    </div>
    <div class="border-t border-slate-700 p-6 flex justify-between items-center bg-black/20">
      <div class="flex items-center gap-2 text-[10px] technical-font text-slate-600"><span class="material-symbols-outlined text-xs">info</span>All fields required</div>
      <div class="flex gap-4"><button onclick="closeNewTaskModal()" class="px-6 py-2 text-xs font-semibold rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors duration-200">CANCEL</button><button id="create-task-btn" onclick="submitNewTask()" disabled class="bg-primary text-black px-8 py-3 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] flex items-center gap-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"><span id="create-task-loading" class="hidden material-symbols-outlined text-sm animate-spin">sync</span><span class="material-symbols-outlined text-sm">bolt</span>Create Task</button></div>
    </div>
  </div>
</div>

<div id="create-repo-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closeCreateRepoModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-2xl flex flex-col shadow-2xl">
    <div class="border-b border-slate-700 p-6 flex justify-between items-center bg-black/40"><div class="flex items-center gap-4"><span class="material-symbols-outlined text-primary text-2xl">source</span><div><h2 class="technical-font text-lg font-bold text-white tracking-widest">Create Repository</h2><p class="text-[10px] technical-font text-slate-500">GitHub, local, or remote computer</p></div></div><button onclick="closeCreateRepoModal()" class="text-slate-500 hover:text-primary transition-colors"><span class="material-symbols-outlined">close</span></button></div>
    <div class="p-6 space-y-6 max-h-[70vh] overflow-y-auto">
      <section class="space-y-4"><div><label class="technical-font text-[10px] text-slate-500 mb-2 block uppercase">Where to create</label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm">place</span><select id="create-repo-location" class="w-full bg-black border border-slate-700 text-slate-300 technical-font text-xs py-3 pl-10 pr-10 focus:ring-1 focus:ring-primary focus:border-primary transition-all cursor-pointer hover:border-slate-600"><option value="github">GITHUB</option><option value="local">THIS COMPUTER (LOCAL)</option><option value="remote">REMOTE COMPUTER</option></select><span class="absolute right-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm pointer-events-none">expand_more</span></div></div><div><label class="technical-font text-[10px] text-slate-500 mb-2 block uppercase">Repository name</label><input id="create-repo-name" type="text" placeholder="my-new-repo" class="w-full bg-black border border-slate-700 text-slate-300 technical-font text-xs py-3 px-4 focus:ring-1 focus:ring-primary focus:border-primary transition-all" /></div></section>
      <section id="create-repo-github-settings" class="space-y-4"><div class="flex items-center gap-2"><span class="material-symbols-outlined text-primary text-sm">cloud</span><h3 class="technical-font font-bold text-slate-300">GitHub Settings</h3></div><div><label class="technical-font text-[10px] text-slate-500 mb-2 block uppercase">Owner (org or personal)</label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm">person</span><select id="create-repo-github-owner" class="w-full bg-black border border-slate-700 text-slate-300 technical-font text-xs py-3 pl-10 pr-10 focus:ring-1 focus:ring-primary focus:border-primary transition-all cursor-pointer hover:border-slate-600"><option value="">LOADING...</option></select><span class="absolute right-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm pointer-events-none">expand_more</span></div><p class="mt-2 text-[10px] technical-font text-slate-600">Requires a GitHub token in Settings.</p></div><div class="grid grid-cols-2 gap-4"><button type="button" id="create-repo-visibility-public" class="visibility-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all bg-black/20"><div class="technical-font text-[11px] font-bold text-slate-300 mb-1">PUBLIC</div><div class="text-[9px] text-slate-500 uppercase leading-tight">Visible to everyone</div></button><button type="button" id="create-repo-visibility-private" class="visibility-btn border border-slate-700 p-4 text-left hover:border-primary/50 transition-all"><div class="technical-font text-[11px] font-bold text-slate-300 mb-1">PRIVATE</div><div class="text-[9px] text-slate-500 uppercase leading-tight">Invite-only access</div></button></div></section>
      <section id="create-repo-local-settings" class="hidden space-y-4"><div class="flex items-center gap-2"><span class="material-symbols-outlined text-primary text-sm">folder</span><h3 class="technical-font font-bold text-slate-300">Local Settings</h3></div><div><label class="technical-font text-[10px] text-slate-500 mb-2 block uppercase">Directory</label><input id="create-repo-local-dir" type="text" placeholder="e.g., ~/GitHub" class="w-full bg-black border border-slate-700 text-slate-300 technical-font text-xs py-3 px-4 focus:ring-1 focus:ring-primary focus:border-primary transition-all" /><p class="mt-2 text-[10px] technical-font text-slate-600">Defaults to your first GitHub path (Settings) when available.</p></div></section>
      <section id="create-repo-remote-settings" class="hidden space-y-4"><div class="flex items-center gap-2"><span class="material-symbols-outlined text-primary text-sm">computer</span><h3 class="technical-font font-bold text-slate-300">Remote Computer</h3></div><div><label class="technical-font text-[10px] text-slate-500 mb-2 block uppercase">Target device</label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm">devices</span><select id="create-repo-remote-device" class="w-full bg-black border border-slate-700 text-slate-300 technical-font text-xs py-3 pl-10 pr-10 focus:ring-1 focus:ring-primary focus:border-primary transition-all cursor-pointer hover:border-slate-600"><option value="">SELECT A COMPUTER...</option></select><span class="absolute right-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-slate-500 text-sm pointer-events-none">expand_more</span></div><p class="mt-2 text-[10px] technical-font text-slate-600">Remote repos are created in the GitHub directory configured on that computer.</p></div></section>
      <p id="create-repo-error" class="hidden text-xs text-red-400"></p>
    </div>
    <div class="border-t border-slate-700 p-6 flex justify-between items-center bg-black/20"><div class="flex items-center gap-2 text-[10px] technical-font text-slate-600"><span class="material-symbols-outlined text-xs">info</span>Name required</div><div class="flex gap-4"><button onclick="closeCreateRepoModal()" class="px-6 py-2 text-xs font-semibold rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors duration-200">CANCEL</button><button id="create-repo-submit-btn" onclick="submitCreateRepo()" class="bg-primary text-black px-8 py-3 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] flex items-center gap-2 transition-all duration-200"><span id="create-repo-loading" class="hidden material-symbols-outlined text-sm animate-spin">sync</span><span class="material-symbols-outlined text-sm">bolt</span>CREATE</button></div></div>
  </div>
</div>

<!-- Pasted Image Viewer Modal -->
<div id="pasted-image-modal" class="hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closePastedImageModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-5xl max-h-[90vh] overflow-hidden shadow-2xl">
    <button onclick="closePastedImageModal()" class="absolute top-3 right-3 text-slate-500 hover:text-primary transition-colors z-10"><span class="material-symbols-outlined text-2xl">close</span></button>
    <div class="p-4"><img id="pasted-image-modal-img" alt="Pasted image preview" class="w-full max-h-[80vh] object-contain bg-black border border-slate-700" /></div>
  </div>
</div>

<!-- Agent Detail Modal -->
<div id="agent-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col rounded-xl">
    <div class="p-8 border-b border-slate-700"><button onclick="closeModal()" class="absolute top-4 right-4 text-slate-500 hover:text-primary transition-colors z-10"><span class="material-symbols-outlined text-2xl">close</span></button><div class="flex items-start gap-4 mb-2"><span id="modal-provider-badge" class="px-3 py-1 text-[10px] technical-font border border-primary text-primary">PROVIDER</span><h2 id="modal-title" class="text-2xl font-display font-bold text-white tracking-widest uppercase">Agent Details</h2></div><div class="flex items-center gap-3"><span id="modal-status-badge" class="px-2 py-0.5 text-[10px] technical-font bg-primary text-black font-bold">STATUS</span><span id="modal-subtitle" class="text-[10px] technical-font text-slate-500">Task overview and activity</span></div></div>
    <div id="modal-content" class="flex-1 overflow-y-auto p-8"><div class="flex items-center justify-center h-32"><span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span></div></div>
    <div class="p-4 bg-black border-t border-slate-700 flex justify-end items-center text-[9px] technical-font text-slate-600"><span id="modal-task-id">Task ID: --</span></div>
  </div>
</div>

<!-- PR Details Modal -->
<div id="pr-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closePrModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl">
    <div class="p-6 border-b border-slate-700 flex justify-between items-start bg-black/40"><div class="flex-1 mr-8"><div class="flex items-center gap-3 mb-2"><span id="pr-modal-number" class="text-slate-500 technical-font text-sm">#0</span><span id="pr-modal-state" class="px-2 py-0.5 text-[10px] technical-font font-bold">OPEN</span></div><h2 id="pr-modal-title" class="text-xl font-display font-bold text-white tracking-tight leading-tight">PR Title</h2></div><button onclick="closePrModal()" class="text-slate-500 hover:text-primary transition-colors"><span class="material-symbols-outlined">close</span></button></div>
    <div class="flex-1 overflow-y-auto p-8 bg-background-dark">
       <div class="grid grid-cols-2 gap-4 mb-8"><div class="bg-[#1A1A1A] border border-slate-700 p-4"><div class="text-[9px] technical-font text-slate-500 mb-1">SOURCE</div><div id="pr-modal-head" class="text-xs font-mono text-primary">feature-branch</div></div><div class="bg-[#1A1A1A] border border-slate-700 p-4"><div class="text-[9px] technical-font text-slate-500 mb-1">TARGET</div><div id="pr-modal-base" class="text-xs font-mono text-slate-300">main</div></div></div>
       <div class="mb-8"><h3 class="text-[11px] technical-font text-slate-500 font-bold mb-3 border-b border-slate-700 pb-2">DESCRIPTION</h3><div id="pr-modal-body" class="prose prose-invert prose-sm max-w-none text-slate-300 font-light leading-relaxed"></div></div>
       <div id="merge-status-container" class="bg-[#1A1A1A] border border-slate-700 p-4 flex items-center justify-between"><div class="flex items-center gap-3"><span id="merge-icon" class="material-symbols-outlined text-emerald-500">check_circle</span><div><div id="merge-title" class="text-sm font-bold text-white">This branch has no conflicts with the base branch</div><div id="merge-subtitle" class="text-xs text-slate-500">Merging can be performed automatically.</div></div></div><div class="flex items-center gap-2"><button id="merge-github-btn" class="hidden border border-slate-600 text-slate-200 px-4 py-2 text-xs font-semibold rounded-lg hover:bg-slate-800 active:scale-[0.98] transition-all duration-200 flex items-center gap-2"><span class="material-symbols-outlined text-sm">open_in_new</span> GITHUB</button><button id="merge-fix-btn" class="hidden bg-primary text-black px-4 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200 flex items-center gap-2"><span class="material-symbols-outlined text-sm">build</span> FIX</button><button id="close-pr-btn" class="hidden border border-red-500/50 text-red-500 px-4 py-2 text-xs font-semibold rounded-lg hover:bg-red-500/10 active:scale-[0.98] transition-all duration-200 flex items-center gap-2"><span class="material-symbols-outlined text-sm">close</span> CLOSE PULL REQUEST</button><button id="merge-btn" class="bg-emerald-600 text-white px-6 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-2"><span class="material-symbols-outlined text-sm">merge</span> MERGE PULL REQUEST</button></div></div>
    </div>
    <div class="p-4 bg-black border-t border-slate-700 flex justify-between items-center text-[10px] technical-font"><a id="pr-modal-link" href="#" class="text-slate-500 hover:text-primary flex items-center gap-1 transition-colors"><span class="material-symbols-outlined text-xs">open_in_new</span> OPEN IN BROWSER</a><span id="pr-modal-meta" class="text-slate-600">Updated just now</span></div>
  </div>
</div>

<!-- Confirm Modal -->
<div id="confirm-modal" class="hidden fixed inset-0 z-[60] flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-md p-6 shadow-2xl flex flex-col items-center text-center rounded-xl"><span class="material-symbols-outlined text-primary text-4xl mb-4">warning</span><h3 id="confirm-title" class="text-lg font-bold text-white uppercase tracking-tight mb-2">Confirm Action</h3><p id="confirm-message" class="text-sm text-slate-400 mb-6 font-light">Are you sure you want to proceed?</p><div class="flex gap-3 w-full"><button id="confirm-cancel-btn" class="flex-1 px-4 py-2 text-xs font-semibold rounded-lg text-slate-400 border border-slate-700 hover:text-white hover:border-slate-500 active:scale-[0.98] transition-all duration-200">CANCEL</button><button id="confirm-ok-btn" class="flex-1 bg-primary text-black px-4 py-2 text-xs font-semibold rounded-lg shadow-sm hover:shadow-md hover:brightness-110 active:scale-[0.98] transition-all duration-200">CONFIRM</button></div></div>
</div>

<!-- Jira Issue Modal -->
<div id="jira-issue-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
  <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="closeJiraIssueModal()"></div>
  <div class="relative bg-sidebar-dark border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl">
    <div class="p-6 border-b border-slate-700 flex justify-between items-start bg-black/40"><div class="flex-1 mr-8"><div class="flex items-center gap-3 mb-2"><span id="jira-issue-modal-key" class="text-primary technical-font text-sm font-bold">--</span><span id="jira-issue-modal-type" class="px-2 py-0.5 text-[10px] technical-font font-bold bg-primary/10 text-primary border border-primary/30">ISSUE</span><span id="jira-issue-modal-status" class="px-2 py-0.5 text-[10px] technical-font font-bold bg-slate-700 text-slate-200">--</span></div><h2 id="jira-issue-modal-title" class="text-xl font-display font-bold text-white tracking-tight leading-tight">Loading...</h2></div><button onclick="closeJiraIssueModal()" class="text-slate-500 hover:text-primary transition-colors"><span class="material-symbols-outlined">close</span></button></div>
    <div id="jira-issue-modal-content" class="flex-1 overflow-y-auto p-8 bg-background-dark"><div class="flex items-center justify-center h-32"><span class="material-symbols-outlined text-primary text-4xl animate-spin">sync</span></div></div>
    <div class="p-4 bg-black border-t border-slate-700 flex justify-between items-center text-[10px] technical-font"><div class="flex items-center gap-4 text-slate-600"><span id="jira-issue-modal-assignee">Assignee: --</span><span id="jira-issue-modal-priority">Priority: --</span></div><div class="flex items-center gap-4 text-slate-600"><span id="jira-issue-modal-created">Created: --</span><span id="jira-issue-modal-updated">Updated: --</span></div></div>
  </div>
</div>

<script src="./src/renderer/marked.js"></script>
<script src="./src/renderer/purify.js"></script>
<script src="./src/renderer/app.js"></script>
</body>
</html>
